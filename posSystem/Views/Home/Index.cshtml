@model posSystem.ViewModels.DashboardViewModel

@{
    ViewData["Title"] = "Admin Dashboard";
}

<div class="container">
    <!-- Dashboard Overview Section -->
    <section class="dashboard-overview">
        <div class="row">
            <!-- Total Sales Widget -->
            <div class="col-md-4 col-lg-3">
                <div class="widget card bg-primary text-white">
                    <div class="card-body">
                        <h5 class="card-title">Total Sales</h5>
                        <p class="card-text">@Model.TotalSales.ToString("N2")</p>
                    </div>
                </div>
            </div>
            <!-- Total Items Widget -->
            <div class="col-md-4 col-lg-3">
                <div class="widget card bg-success text-white">
                    <div class="card-body">
                        <h5 class="card-title">Total Items</h5>
                        <p class="card-text">@Model.TotalItems</p>
                    </div>
                </div>
            </div>
            <!-- Total Categories Widget -->
            <div class="col-md-4 col-lg-3">
                <div class="widget card bg-info text-white">
                    <div class="card-body">
                        <h5 class="card-title">Total Categories</h5>
                        <p class="card-text">@Model.TotalCategories</p>
                    </div>
                </div>
            </div>
            <!-- Total Brands Widget -->
            <div class="col-md-4 col-lg-3">
                <div class="widget card bg-warning text-white">
                    <div class="card-body">
                        <h5 class="card-title">Total Brands</h5>
                        <p class="card-text">@Model.TotalBrands</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Charts Section -->
    <section class="charts-section mt-4">
        <div class="row">
            <!-- Left Column with Sales Chart -->
            <div class="col-md-12 col-lg-6 mb-4">
                <section class="chart-section">
                    <h4 class="mb-3">Sales Overview</h4>
                    <div class="card chart-card shadow-sm">
                        <div class="card-body">
                            <canvas id="salesChart"></canvas>
                        </div>
                    </div>
                </section>
            </div>
            <!-- Right Column with Members and Staff Charts -->
            <div class="col-md-12 col-lg-6">
                <div class="row">
                    <!-- Members Chart Section -->
                    <div class="col-md-12 mb-4">
                        <section class="chart-section">
                            <h4 class="mb-3">Members Overview</h4>
                            <div class="card chart-card shadow-sm">
                                <div class="card-body">
                                    <canvas id="membersChart"></canvas>
                                </div>
                            </div>
                        </section>
                    </div>
                    <!-- Staff Chart Section -->
                    <div class="col-md-12">
                        <section class="chart-section">
                            <h4 class="mb-3">Staff Overview</h4>
                            <div class="card chart-card shadow-sm">
                                <div class="card-body">
                                    <canvas id="staffChart"></canvas>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Recent Sales Section -->
    <section class="recent-sales mt-4">
        <h4 class="mb-3">Recent Sales</h4>
        <table class="table table-sm table-striped">
            <thead>
                <tr>
                    <th>Sale ID</th>
                    <th>Item Name</th>
                    <th>Quantity</th>
                    <th>Total Amount</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var sale in Model.RecentSales)
                {
                    <tr>
                        <td>@sale.saleId</td>
                        @* <td>@sale.itemName</td> *@
                        <td>@sale.saleQty</td>
                        <td>@sale.totalAmount?.ToString("C")</td>
                        <td>@sale.saleDate</td>
                    </tr>
                }
            </tbody>
        </table>
    </section>

    <!-- Recent Activities Section -->
    <section class="recent-activities mt-4">
        <h4 class="mb-3">Recent Activities</h4>
        <ul class="list-group">
            @foreach (var activity in Model.RecentActivities)
            {
                <li class="list-group-item">@activity</li>
            }
        </ul>
    </section>
</div>

<!-- Add custom CSS styling for the dashboard -->
<style>
    .dashboard-overview .widget {
        margin-bottom: 15px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        padding: 10px;
    }

    .dashboard-overview .card-title {
        font-size: 1.2rem;
        margin-bottom: 5px;
    }

    .dashboard-overview .card-text {
        font-size: 1.5rem;
    }

    .chart-section {
        margin-top: 20px;
    }

    .chart-card {
        border-radius: 8px;
        overflow: hidden;
    }

        .chart-card .card-body {
            padding: 20px;
        }

    .recent-sales, .recent-activities {
        margin-top: 20px;
    }

        .recent-sales .table th, .recent-sales .table td {
            text-align: center;
        }
</style>

<!-- Add Chart.js script for rendering the chart -->
<script>
    var salesCtx = document.getElementById('salesChart').getContext('2d');
    var salesChart = new Chart(salesCtx, {
        type: 'line',
        data: {
            labels: @Html.Raw(Json.Serialize(Model.SalesData.Select(d => d.Date))),
            datasets: [{
                label: 'Total Sales Amount',
                data: @Html.Raw(Json.Serialize(Model.SalesData.Select(d => d.TotalAmount))),
                borderColor: 'rgba(75, 192, 192, 1)',
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                fill: true
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    type: 'time',
                    time: {
                        unit: 'day',
                        tooltipFormat: 'll'
                    },
                    title: {
                        display: true,
                        text: 'Date'
                    }
                },
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Sales Amount'
                    }
                }
            }
        }
    });

    var membersCtx = document.getElementById('membersChart').getContext('2d');
    var membersChart = new Chart(membersCtx, {
        type: 'bar',
        data: {
            labels: @Html.Raw(Json.Serialize(Model.MembersData.Select(m => m.Level))),
            datasets: [{
                label: 'Number of Members',
                data: @Html.Raw(Json.Serialize(Model.MembersData.Select(m => m.Count))),
                backgroundColor: 'rgba(255, 159, 64, 0.2)',
                borderColor: 'rgba(255, 159, 64, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Member Level'
                    }
                },
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Count'
                    }
                }
            }
        }
    });

    var staffCtx = document.getElementById('staffChart').getContext('2d');
    var staffChart = new Chart(staffCtx, {
        type: 'doughnut',
        data: {
            labels: @Html.Raw(Json.Serialize(Model.StaffData.Select(s => s.Role))),
            datasets: [{
                label: 'Number of Staff',
                data: @Html.Raw(Json.Serialize(Model.StaffData.Select(s => s.Count))),
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutoutPercentage: 60,
            plugins: {
                legend: {
                    position: 'right',
                },
            }
        }
    });
</script>
